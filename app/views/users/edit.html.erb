<h1 class="mx-auto" style="width: 75%">ユーザ情報編集画面</h1>

<div class="new-trouble-form" id="border-default">
  <%= form_with model: @user, url: users_path, local:true do |f|%>
  
    <table class="mx-auto new-trouble-table">
      <tbody>
        <tr>
          <th><%= f.label :名前%></th>
          <td style="width: 83%"><%= f.text_field :name, autofocus: true, placeholder:"#{@user.name}", class: "user-edit-form" %></td>
        </tr>
        <tr>
          <th><%= f.label :メールアドレス%></th>
          <td><%= f.email_field :email, placeholder:"#{@user.email}", class: "user-edit-form" %></td>
        </tr>
        <tr>
          <th><%= f.label :プロフィール画像 , class: "mt-3 mb-3"%></th>
          <td>
            <%= attachment_image_tag @user, :profile_image,format: 'jpeg', fallback: "no_image.jpg", size:"100x100", class: "ml-3 rounded-circle", id: :img_prev %>
            <%= f.attachment_field :profile_image, placeholder: "プロフィール画像", id: :profile_img, class: "ml-4 btn btn-outline-dark" %>
          </td>
        </tr>
      </tbody>
    </table>
  
    <div class="new-trouble-submit-form text-center mt-3 pb-4">
      <%= f.submit "編集内容を保存", class: "btn btn-primary px-5" %>
    </div>
  
  <% end %>
</div>


<script type="text/javascript">
$(function() {
 function readURL(input) {
   if (input.files && input.files[0]) {
     var reader = new FileReader();
     reader.onload = function (e) {
       $('#img_prev').attr('src', e.target.result);
     }
     reader.readAsDataURL(input.files[0]);
   }
 }
 $("#profile_img").change(function(){
   readURL(this);
 });
});
</script>
